{% extends "core/base.html" %}
{% load static %}

{% block title %}
Intervenciones {{ date|date:"d/m/Y" }} - Panel OVA
{% endblock %}

{% block content %}
<section class="card">
  <div class="card-header">
    <h2>Intervenciones del {{ date|date:"d/m/Y" }}</h2>
    <p class="card-sub">
      Listado de pacientes programados para este día.
    </p>
  </div>

  {% if patients %}
    <table class="table">
      <thead>
        <tr>
          <th>Nombre</th>
          <th>Cobertura</th>
          <th>Médico</th>
          <th>Servicio</th>
          <th>Estado</th>
          <th>Acciones</th>
        </tr>
      </thead>
      <tbody>
        {% for p in patients %}
          <tr>
            <td>{{ p.full_name }}</td>
            <td>{{ p.coverage }}</td>
            <td>{{ p.doctor }}</td>
            <td>{{ p.service }}</td>
            <td>
              {% if p.status == p.STATUS_PENDIENTE %}
                <span class="badge badge-pendiente">Pendiente</span>
              {% elif p.status == p.STATUS_SOLICITADO %}
                <span class="badge badge-solicitado">Solicitado</span>
              {% elif p.status == p.STATUS_AUTORIZADO %}
                <span class="badge badge-autorizado">Autorizado</span>
              {% elif p.status == p.STATUS_MATERIAL_PENDIENTE %}
                <span class="badge badge-material">Material pendiente</span>
              {% elif p.status == p.STATUS_RECHAZO %}
                <span class="badge badge-rechazado">Rechazo</span>
              {% elif p.status == p.STATUS_REPROGRAMADO %}
                <span class="badge badge-reprogramado">Reprogramado</span>
              {% else %}
                <span class="badge">{{ p.get_status_display }}</span>
              {% endif %}
            </td>
            <td>
              <a href="{% url 'core:patient_detail' p.id %}" class="btn-primary btn-small">
                Ver
              </a>
            </td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  {% else %}
    <p style="font-size:0.9rem; color:#6b7280; margin-top:0.5rem;">
      No hay intervenciones programadas para este día.
    </p>
  {% endif %}

  <div class="form-actions" style="margin-top:1rem;">
    <a href="{% url 'core:calendar' %}" class="btn-secondary btn-small">
      ← Volver al calendario
    </a>
  </div>
</section>
{% endblock %}
